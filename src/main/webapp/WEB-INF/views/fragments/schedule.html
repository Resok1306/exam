<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      lang="ko"
      layout:decorate="~{fragments/layout}">
<head>
    <meta charset="UTF-8">
    <title>User List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>
<section layout:fragment="content">
<div class="container mt-5">
    <h2 class="mb-4">User List</h2>
    <button id="loadBtn" class="btn btn-primary mb-3">사용자 목록 불러오기</button>
    <table class="table table-bordered table-hover">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Username</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Website</th>
            </tr>
        </thead>
        <tbody id="userTableBody">
        </tbody>
    </table>
</div>

<script>
$(function(){
    $('#loadBtn').click(function(){
        $.ajax({
            url: '/api/users',
            type: 'GET',
            dataType: 'json',
            success: function(users) {
                const tbody = $('#userTableBody');
                tbody.empty(); // 기존 내용 제거

                $.each(users, function(index, user) {
                    const row = `
                        <tr>
                            <td>${user.id}</td>
                            <td>${user.name}</td>
                            <td>${user.username}</td>
                            <td>${user.email}</td>
                            <td>${user.phone}</td>
                            <td>${user.website}</td>
                        </tr>`;
                    tbody.append(row);
                });
            },
            error: function(xhr, status, error) {
                alert('데이터를 불러오는 중 오류 발생: ' + error);
            }
        });
    });
});
</script>
</section>
</body>
</html>